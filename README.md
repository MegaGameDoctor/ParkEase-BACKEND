# ParkEase-BACKEND
## Описание
ParkEase - проект сервиса для бронирования парковочных мест. Проект включает в себя сайт (React -> JS, CSS, HTML) и серверную часть с базой данных (PHP, SQL). На сайте пользователь может зарегистрироваться или авторизоваться, затем на самом сайте выбрать одну из неограниченного числа парковку, занять там место или просто ознакомиться с её картой. Администратор сайта может добавить бесчисленное множество разных парковок с разными изображениями карты, а на каждой парковке указать неограниченное число парковочных мест с совершенно любым положением.
## Фрагменты проекта
Сейчас вы находитесь в репозитории с BACKEND-ом проекта. Ознакомиться внешней частью можно здесь: [ССЫЛКА](https://github.com/xxxxxneonxxxxx/ParkEase)
## API
Серверная часть представляет из себя набор нужных методов для работы сайта и проведени всех его функциональных процессов. Для обращения к API используется метод GET или POST. Для запроса к любому из методов требуется указывать token сессии, это не касается методов regUser.php и authUser.php. Каждый ответ формируется в формате JSON и содержит в себе поле status. Если status=false, значит данные следует брать из поля error, которое содержит текст ошибки. При status=true данные берутся из поля data.
1) regUser.php - Принимает на вход параметры f_name (Имя), l_name (Фамилия), company (Код компании), birthdate (Дата рождения), mailOrPhone (Номер телефона или почта) и password (Пароль). Возвращает либо ошибку и status=false, либо status=true и сгенерированный токен сессии, создавая аккаунт в базе данных.
2) authUser.php - Принимает на вход параметры mailOrPhone (Номер телефона или почта) и password (Пароль). В случае успешной валидации и проверки данных возвращает сгенерированный токен сессии и status=true.
3) checkSession.php - Принимает на вход token (Токен сессии). Дополнительный способ проверки сессии.
4) getUserInfo.php - Принимает на вход token (Токен сессии). Возвращает всевозможные данные о пользователе, а именно: Айди, Имя, Фамилия, Данные о компании, Номер телефона, Почта, Доступные парковки, Занятые парковочные места и данные о них.
5) getParkInfo.php - Принимает на вход token (Токен сессии) и park (Айди парковки). Возвращает всевозможные данные о парковке, а именно: Айди, Айди компании, Название, Данные о карте, Данные о местах. В свою очередь данные о карте включают в себя: URL изображения, Ширину и Длину. Данные о местах включают в себя: Айди, Айди пользователя (Который занял место), Положение по X, Положение по Y, Ширина, Длина, Угол поворота, Номер на карте, Дата изменения.
6) parkPlaceAction.php - Принимает на вход token (Токен сессии), park (Айди парковки), place (Айди места), car (Номер машины) и carType (Марка машины). Во всех успешных случаях возвращает параметр ownedBy (Кем занято место). В таком случае если ownedBy = 0, если пользователь успешно освободил занятое место и ownedBy = Айди пользователя, если пользователь успешно занял указанное парковочное место.
## База данных
База данных MySQL состоит из 6 таблиц:
1) accounts - Таблица с данными об аккаунтах. Включает в себя столбцы id (Айди), f_name (Имя), l_name (Фамилия), companyID (Айди компании), phone (Номер телефона), email (Почта), password (Пароль в MD5), regDate (Дата регистрации).
2) companies - Таблица с данными о компаниях. Включает в себя столбцы id (Айди), name (Название), code (Код компании), descr (Описание).
3) parks - Таблица с данными о парковках. Включает в себя столбцы id (Айди), companyID (Айди компании, к которой относится парковка), name (Название).
4) park_images - Таблица с данными об изображениях карты парковок. Включает в себя столбцы id (Айди), parkID (Айди парковки, к которому относится изображение), url (Прямая ссылка на изображение), width (Ширина), height (Длина).
5) park_places - Таблица с данными о парковочных местах. Включает в себя столбцы id (Айди), ownedBy (Айди пользователя, который занял это место), x (Координата положения по X), y (Координата положения по Y), height (Длина), width (Ширина), rotate (Угол поворота), numb (Номер на карте), car (Номер машины), carType (Марка машины), changeDate (Дата изменения).
6) sessions - Таблица с данными о сессиях. Включает в себя столбцы token (Секретный токен сессии), start (Дата начала сессии), userID (Пользователь), ip (Айпи сессии), finish (Дата завершения сессии).
## Размещение
Чтобы разместить - достаточно загрузить файлы в любую удобную дирректорию WEB сервера и указать данные для подключения к базе данных в файле config.php, а также импортировать в саму базу данных файл db.sql из этого репозитория.
